# GitAgent 技术架构图

## 系统架构概览

```
┌─────────────────────────────────────────────────────────────────┐
│                        GitAgent 系统架构                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌──────────────┐ │
│  │   前端界面层     │    │   业务逻辑层     │    │   服务层      │ │
│  │                 │    │                 │    │              │ │
│  │ ┌─────────────┐ │    │ ┌─────────────┐ │    │ ┌──────────┐ │ │
│  │ │   App.tsx   │ │    │ │useDeployment│ │    │ │Claude API│ │ │
│  │ │             │ │    │ │             │ │    │ │          │ │
│  │ │ 主界面组件   │ │◄──►│ │ 部署逻辑Hook │ │◄──►│ │ AI服务   │ │ │
│  │ │             │ │    │ │             │ │    │ │          │ │ │
│  │ └─────────────┘ │    │ └─────────────┘ │    │ └──────────┘ │ │
│  │                 │    │                 │    │              │ │
│  │ ┌─────────────┐ │    │ ┌─────────────┐ │    │ ┌──────────┐ │ │
│  │ │ Components  │ │    │ │Deployment   │ │    │ │SSH连接   │ │ │
│  │ │             │ │    │ │Service      │ │    │ │管理      │ │ │
│  │ │ 功能组件库   │ │◄──►│ │ 部署服务    │ │◄──►│ │          │ │ │
│  │ │             │ │    │ │             │ │    │ │          │ │ │
│  │ └─────────────┘ │    │ └─────────────┘ │    │ └──────────┘ │ │
│  └─────────────────┘    └─────────────────┘    └──────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 组件关系图

```
┌─────────────────────────────────────────────────────────────────┐
│                        GitAgent 组件关系图                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    App.tsx (主应用)                          │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │ ClaudeConfig│  │ FileUpload  │  │   Deployment UI     │  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ API配置组件  │  │ 文件上传组件 │  │   部署相关组件       │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  │                           │                    │            │ │
│  │                           ▼                    ▼            │ │
│  │  ┌─────────────────────────────────────────────────────────┐ │ │
│  │  │                useDeployment Hook                       │ │ │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────┐  │ │ │
│  │  │  │ 状态管理     │  │ 日志管理     │  │   错误处理       │  │ │ │
│  │  │  │             │  │             │  │                 │  │ │ │
│  │  │  │ 部署状态     │  │ 实时日志     │  │   异常恢复       │  │ │ │
│  │  │  └─────────────┘  └─────────────┘  └─────────────────┘  │ │ │
│  │  └─────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                           │                                      │
│                           ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                DeploymentService (部署服务)                  │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │ 智能体管理   │  │ 流程控制     │  │   结果处理           │  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ 多智能体协作 │  │ 部署流程     │  │   部署总结           │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                           │                                      │
│                           ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                ClaudeService (AI服务)                        │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │ 项目分析     │  │ 命令生成     │  │   错误诊断           │  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ 技术栈识别   │  │ 部署命令     │  │   问题解决           │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 智能体协作流程图

```
┌─────────────────────────────────────────────────────────────────┐
│                       智能体协作流程                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │ProjectAnalyzer│  │ServerConnector│  │DeploymentStrategy   │  │
│  │             │    │             │    │                     │  │
│  │ 项目分析智能体 │  │ 服务器连接智能体 │  │ 部署策略智能体       │  │
│  │             │    │             │    │                     │  │
│  └─────────────┘    └─────────────┘    └─────────────────────┘  │
│         │                   │                   │              │
│         ▼                   ▼                   ▼              │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │CommandGenerator│  │DeploymentValidator│  │DeploymentGuide   │  │
│  │             │    │             │    │                     │  │
│  │ 命令生成智能体 │  │ 部署验证智能体   │  │ 部署指导智能体       │  │
│  │             │    │             │    │                     │  │
│  └─────────────┘    └─────────────┘    └─────────────────────┘  │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    错误处理流程                              │ │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────────┐  │ │
│  │  │ 错误检测     │───►│ 错误分析     │───►│ 错误修复         │  │ │
│  │  │             │    │             │    │                 │  │ │
│  │  │ 异常捕获     │    │ AI诊断       │    │ 自动修复/用户指导 │  │ │
│  │  └─────────────┘    └─────────────┘    └─────────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 数据流图

```
┌─────────────────────────────────────────────────────────────────┐
│                        GitAgent 数据流图                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  用户输入 ──► 配置验证 ──► 部署启动 ──► 智能体执行 ──► 结果输出    │
│     │           │           │           │           │          │
│     ▼           ▼           ▼           ▼           ▼          │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │GitHub URL│ │API Key  │ │部署配置 │ │多智能体 │ │部署日志 │  │
│  │服务器配置│ │SSH密钥  │ │验证     │ │协作     │ │状态更新 │  │
│  │         │ │         │ │         │ │         │ │结果总结 │  │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘  │
│     │           │           │           │           │          │
│     ▼           ▼           ▼           ▼           ▼          │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    状态管理 (useDeployment)                 │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │ 部署状态     │  │ 日志记录     │  │   错误状态           │  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ 进度跟踪     │  │ 实时更新     │  │   异常处理           │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 技术栈依赖关系

```
┌─────────────────────────────────────────────────────────────────┐
│                       技术栈依赖关系                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    前端技术栈                                │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │   React     │  │ TypeScript  │  │    Tailwind CSS     │  │ │
│  │  │    18.3.1   │  │    5.5.3    │  │       3.4.1        │  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ UI框架      │  │ 类型系统     │  │   样式框架           │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  │         │                 │                   │            │ │
│  │         ▼                 ▼                   ▼            │ │
│  │  ┌─────────────────────────────────────────────────────────┐ │ │
│  │  │                    Vite 5.4.2                           │ │ │
│  │  │                构建工具和开发服务器                      │ │ │
│  │  └─────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                           │                                      │
│                           ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    后端服务                                  │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │ Claude API  │  │ SSH连接     │  │   文件处理           │  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ AI服务      │  │ 远程连接     │  │   密钥管理           │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 部署流程时序图

```
┌─────────────────────────────────────────────────────────────────┐
│                       部署流程时序图                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  用户界面    │  部署Hook   │  部署服务   │  Claude API │  远程服务器 │
│             │             │             │             │             │
│     │       │      │      │      │      │      │      │      │      │
│     │──配置─►│      │      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │──启动─►│      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │──分析─►│      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │      │──请求─►│      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │      │      │──响应─►│      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │──连接─►│      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │──连接─►│      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │──验证─►│      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │──部署─►│      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │──命令─►│      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │──执行─►│      │
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │──结果─►│
│     │       │      │      │      │      │      │      │      │      │
│     │       │      │──完成─►│      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
│     │──结果─►│      │      │      │      │      │      │      │      │
│     │       │      │      │      │      │      │      │      │      │
└─────────────────────────────────────────────────────────────────┘
```

## 错误处理流程图

```
┌─────────────────────────────────────────────────────────────────┐
│                       错误处理流程图                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │   错误发生   │───►│  错误捕获    │───►│   错误分类           │  │
│  │             │    │             │    │                     │  │
│  │ 部署异常     │    │ 异常处理     │    │ 网络/权限/配置错误   │  │
│  └─────────────┘    └─────────────┘    └─────────────────────┘  │
│         │                   │                   │              │
│         ▼                   ▼                   ▼              │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │ Claude分析   │    │ 自动修复     │    │   用户交互           │  │
│  │             │    │             │    │                     │  │
│  │ AI诊断错误   │    │ 重试机制     │    │ 用户输入/确认        │  │
│  └─────────────┘    └─────────────┘    └─────────────────────┘  │
│         │                   │                   │              │
│         ▼                   ▼                   ▼              │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    错误恢复                                  │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │ 继续部署     │  │ 回滚操作     │  │   终止部署           │  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ 修复后继续   │  │ 恢复到之前   │  │   完全停止           │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

*架构图版本：1.0*  
*更新时间：2024年7月8日*  
*维护者：GitAgent 开发团队* 