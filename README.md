# GitAgent - 多智能体自动部署系统

基于 Claude AI 的智能部署系统，支持传统多智能体部署和安全的 SSH 终端部署两种模式。

## 🚀 新功能：SSH 终端部署模式

### 特性
- **🔐 安全性**: 私钥在浏览器本地处理，不传输到远程服务器
- **🖥️ 实时终端**: 基于 xterm.js 的全功能终端模拟器
- **🤖 智能自动化**: 支持自动化部署和错误检测
- **🔄 交互式部署**: 实时查看部署过程，支持手动干预

### 技术架构
- **前端**: React + TypeScript + xterm.js
- **后端**: Node.js + WebSocket + SSH2
- **安全**: 本地私钥处理，WebSocket 加密传输

## 📦 安装依赖

```bash
# 安装前端依赖
npm install

# 安装后端依赖（SSH 代理服务）
npm install express ws ssh2 cors
```

## 🛠️ 使用方法

### 方式一：同时启动前端和 SSH 代理服务
```bash
npm run dev-with-proxy
```

### 方式二：分别启动
```bash
# 终端1：启动 SSH 代理服务
npm run ssh-proxy

# 终端2：启动前端开发服务器
npm run dev
```

### 方式三：手动启动
```bash
# 启动 SSH 代理服务
node start-ssh-proxy.js

# 启动前端
npm run dev
```

## 🔧 配置说明

### SSH 连接配置
- **服务器地址**: 目标服务器的 IP 地址
- **端口**: SSH 端口（默认 22）
- **用户名**: SSH 用户名
- **私钥文件**: SSH 私钥文件（.pem, .key 格式）

### 部署模式选择

#### 1. 传统智能体模式
- 使用多智能体协作进行自动化部署
- AI 驱动的错误处理和问题解决
- 适合复杂项目的自动化部署

#### 2. SSH 终端模式
- 直接在浏览器中使用 SSH 终端
- 私钥本地处理，更安全
- 支持实时交互和手动控制
- 智能错误检测和自动修复建议

## 🏗️ 项目结构

```
gitagent/
├── src/
│   ├── components/
│   │   ├── SSHTerminal.tsx          # SSH 终端组件
│   │   ├── AgentStatus.tsx          # 智能体状态
│   │   ├── DeploymentProgress.tsx   # 部署进度
│   │   └── ...
│   ├── services/
│   │   ├── sshProxy.js             # SSH 代理服务
│   │   ├── claudeService.ts        # Claude AI 服务
│   │   └── deploymentService.ts    # 部署服务
│   └── ...
├── xterm.js/                       # xterm.js 源码
├── start-ssh-proxy.js              # SSH 代理启动脚本
└── package.json
```

## 🔐 安全特性

### 私钥安全处理
- 私钥文件在浏览器本地读取和处理
- 通过 WebSocket 加密传输到本地代理服务
- 不经过任何远程服务器
- 连接结束后自动清理

### 连接安全
- 本地代理服务器作为中介
- WebSocket 安全连接
- 支持连接超时和自动重连
- 心跳检测保持连接活跃

## 🤖 智能功能

### 自动化部署
- 自动检测项目类型（React, Vue, Python 等）
- 生成适合的部署步骤
- 智能依赖安装和环境配置
- 自动化构建和启动流程

### 错误处理
- 实时错误检测和分析
- AI 驱动的错误诊断
- 自动修复建议
- 智能重试机制

### 交互式操作
- 支持密码输入和确认提示
- 实时命令输出显示
- 支持 Ctrl+C 中断操作
- 完整的终端功能支持

## 📊 监控和日志

### 连接监控
- 实时连接状态显示
- 连接数量统计
- 错误日志记录
- 性能监控

### 部署日志
- 详细的部署步骤记录
- 错误信息和堆栈跟踪
- 执行时间统计
- 成功/失败状态跟踪

## 🚀 部署流程

### SSH 终端模式部署流程
1. 配置服务器连接信息
2. 上传 SSH 私钥文件
3. 选择 SSH 终端模式
4. 点击"打开SSH终端"
5. 自动建立 SSH 连接
6. 输入项目 GitHub 地址
7. 点击"开始自动部署"
8. 系统自动执行部署步骤
9. 实时查看部署进度和日志
10. 部署完成或错误处理

### 传统智能体模式
1. 配置 Claude API Key
2. 输入项目和服务器信息
3. 选择传统智能体模式
4. 点击"开始智能部署"
5. 多智能体协作执行部署
6. AI 驱动的错误处理
7. 查看部署结果和总结

## 🔧 故障排除

### 常见问题
1. **SSH 连接失败**
   - 检查服务器地址和端口
   - 确认私钥文件格式正确
   - 检查防火墙设置

2. **WebSocket 连接失败**
   - 确认 SSH 代理服务已启动
   - 检查端口 3000 是否被占用
   - 查看浏览器控制台错误

3. **部署失败**
   - 检查服务器权限设置
   - 确认依赖环境已安装
   - 查看详细错误日志

### 调试模式
```bash
# 启动调试模式
DEBUG=ssh-proxy node start-ssh-proxy.js
```

## 📝 更新日志

### v2.0.0 (最新)
- ✨ 新增 SSH 终端部署模式
- 🔐 增强私钥安全处理
- 🖥️ 集成 xterm.js 终端模拟器
- 🤖 智能自动化部署功能
- 📊 实时监控和日志系统

### v1.0.0
- 🤖 多智能体协作部署
- 🧠 Claude AI 集成
- 📈 部署进度可视化
- 🔍 错误分析和处理

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## �� 许可证

MIT License
